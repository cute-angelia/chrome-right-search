var _gaq;_gaq=_gaq||[],_gaq.push(["_setAccount","UA-35761644-1"]),_gaq.push(["_trackPageview"]),function(e,t,n,r,a,i,u){var c;return localStorage.analytics?(c=document.createElement("script"),c.type="text/javascript",c.async=!0,c.src="https://ssl.google-analytics.com/ga.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(c,t),window.ga=function(e,t,n,r){return n?_gaq.push(["_trackEvent",n,r]):void 0}):window.ga=function(){return console.debug(arguments)}}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-35761644-1"),ga("send","pageview");var app,ctrls,utilsDirectives;app=angular.module("popup",["pascalprecht.translate","popup.controllers","utils.directives"]),ctrls=angular.module("popup.controllers",[]),utilsDirectives=angular.module("utils.directives",[]),app.config(["$translateProvider",function(e){var t,n,r,a,i,u;for(r in TRANSLATIONS.zh_CN)for(t=0,i=LANGUAGE.length;i>t;t++)a=LANGUAGE[t],r in TRANSLATIONS[a]||(TRANSLATIONS[a][r]=r);for(n=0,u=LANGUAGE.length;u>n;n++)a=LANGUAGE[n],e.translations(a,TRANSLATIONS[a]);return e.registerAvailableLanguageKeys(LANGUAGE,{"zh-cn":"zh_CN","zh-tw":"zh_TW",en:"en",ru:"ru"}).determinePreferredLanguage().fallbackLanguage("en"),e.useSanitizeValueStrategy("escaped")}]);var lsGet,indexOf=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};lsGet=function(e,t){return null==t&&(t=e),e in localStorage?JSON.parse(localStorage[e]):t},ctrls.controller("PopupCtrl",["$scope","$translate",function(e,t){var n;return ga("send","event","popup","open"),n=lsGet("locale",""),n||(n=navigator.language.replace("-","_")),indexOf.call(LANGUAGE,n)<0&&(n="en"),t.use(n),e.text="",e.btns=[],e.defaultSearch=function(){return e.btns.length>0?e.search(e.btns[0].id):void 0},e.read=function(t,n){var r,a,i,u,c,o,s,l,p,d,g,v,f,h,m,y,A;for(e.text=n,e.type=t,i=lsGet(t+"Back",[]),p=lsGet(t+"Incognito",[]),m=lsGet(e.type+"Select",[]),u=lsGet(t+"Custom",[]),c=lsGet(t[0]+"cGroup",[]),A=lsGet("all",[]),h=lsGet("names",{}),o=0,g=m.length;g>o;o++){for(s=m[o],r=!0,d=0,v=A.length;v>d;d++)y=A[d],y.c===s&&(r=!1,f=s,f||(f=y.n),y.c in h&&(f=h[y.c]));r&&(f=s),f||(f=s),l=indexOf.call(p,s)>=0,l?f="☢ "+f:(a=indexOf.call(i,s)>=0,a&&(f="₪ "+f)),e.btns.push({id:s,name:f})}return e.$apply()},chrome.tabs.query({active:!0,windowId:chrome.windows.WINDOW_ID_CURRENT},function(t){var n;return n=t[0].id,/http.+|ftp.+/.test(t[0].url)?chrome.tabs.executeScript(n,{code:'[document.head.getAttribute("data-c-m-t"),document.head.getAttribute("data-c-m-v")]'},function(t){return t&&t[0]&&t[0][0]?e.read(t[0][0],t[0][1]):chrome.tabs.executeScript(n,{code:'var _v;var _t=document.body.getElementsByTagName("input");for(var i in _t){if(_t[i].type=="text"){_v=_t[i].value;break;}}_v;'},function(t){var n;return n="",t&&t[0]&&(n=t[0]),e.read("txt",n)})}):e.read("txt","")}),e.search=function(t){return chrome.tabs.getSelected(null,function(n){return chrome.runtime.getBackgroundPage(function(r){return r.openTab(t,e.type,e.text,!1,n)})}),ga("send","event","popup",t)},1}]),utilsDirectives.directive("enter",function(){return function(e,t,n){return t.bind("keydown",function(t){var r;return 13===t.keyCode?n.enter?e.$apply(n.enter):(t.preventDefault(),r=$("input").index(this)+1,$("input:eq("+r+")").focus()):void 0})}}),utilsDirectives.directive("integer",function(){var e;return e=/^\-?\d*$/,{require:"ngModel",link:function(t,n,r,a){return a.$parsers.unshift(function(t){return e.test(t)?(a.$setValidity("integer",!0),t):void a.$setValidity("integer",!1)})}}}),utilsDirectives.directive("json",function(){return{replace:!0,template:"<span>{{ value }}</span>",restrict:"E",link:function(e,t,n){var r,a;if(r=n.url){a=new XMLHttpRequest,a.open("GET",chrome.extension.getURL(r)),a.onreadystatechange=function(){var t;return 4===this.readyState&&this.responseText&&(t=n.key)?e.value=JSON.parse(this.responseText)[t]:void 0};try{return a.send()}catch(i){}}}}});